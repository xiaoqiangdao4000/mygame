{"version":3,"sources":["file:///Users/zzx/Desktop/mygame/assets/scripts/mjNode.ts"],"names":["_decorator","Button","color","Component","Game","game","instantiate","Intersection2D","Label","Node","Prefab","ProgressBar","Rect","Sprite","tween","Vec3","tools","GAMESTATE","GAMETIPS","SOUND","gameStart","AudioMgr","ccclass","property","mjNode","type","tips_title_label","tips_xipai_label","tips_chehui_label","tips_addtime_label","tips_toushi_label","tips_music_label","tips_sound_label","tips_music_node","tips_sound_node","gameContinueBtn","gameRestBtn","gameNextBtn","isCanClick","desktopItems","desktopCuritem","randomIndex","desktopItemCount","time","allTime","gameState","game_start","tabItemPos","tabItem","onLoad","console","log","frame","gameTipsNode","getChildByName","getComponent","node","on","onClickMj","getData","updataBtn","self","EVENT_HIDE","gameShowTips","game_seting","EVENT_SHOW","start","i","tabNodes","length","pos","x","y","pos1","getPosition","push","startGame","level","cleanMj","cardBackNow","cardBackTotal","setLevelTime","active","Instance","hide","randomMjAnim","initDesktopMj","timeLabel","string","timeProgressBar","progress","destroyAllChildren","onBtnClick","event","customEventData","gameMusic","pauseBgm","resumeBgm","gameSound","setMenu","playSound","click_sound","contiuneGame","setLevelLabel","show","unscheduleAllCallbacks","parent","destroy","xiPai","cheHui","addTime","touShi","setBtnState","music","label","unschedule","countdown","desktopScript","delay","call","sendCard_sound","playAnimation","animType","refreshDeaktopMj","schedule","index","item","mjcard","setInsterEndPos","setCanClick","t1","to","position","sPos","t2","restSibingIndex","sequence","pop","start_sound","setTouShi","insertItem","insertCallBack","deleteDesktopItems","isTabCanDelete","gmae_fail","deleteTabAnima","clear_sound","splice","restTopAnima","update","deltaTime","getRandomMjIndex","createDesktopMj","time_sound","refresh","mj","mycard_prefab","mycard","initMj","game_inGame","itemsXJ","j","pos2","rect1","rect2","rectRect","itemsXJ1","Array","from","Set","maxNodeItem","reduce","a","b","getSiblingIndex","mjscrpit","interaction","cardId","tempIndex","name","callback","restCard","setSiblingIndex","node2","node1","node0","union","repeat","removeSelf","game_success","typeId","game_hide","gameLost_sound","game_end","saveLevel","savaData","gameWin_sound","bttName","enable","btnText","enabled"],"mappings":"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","sourcesContent":["import { _decorator, Button, color, Component, Game, game, instantiate, Intersection2D, Label, Node, Prefab, ProgressBar, Rect, Sprite, tween, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\nimport tools, { GAMESTATE, GAMETIPS, SOUND } from './tools'\nimport { gameStart } from './gameStart';\nimport { mjcard } from './mjcard';\nimport AudioMgr from './audioManager';\n//const { systemEvent } = cc;\n\n@ccclass('mjNode')\nexport class mjNode extends Component {\n\n    @property(Prefab)\n    mycard_prefab: Prefab | null = null;\n\n    @property(ProgressBar)\n    timeProgressBar: ProgressBar | null = null;\n\n    @property(Label)\n    timeLabel: Label | null = null;\n\n    @property(Node)\n    gameTipsNode: Node | null = null;\n\n    @property({\n        type: [Node]\n    })\n    tabNodes: Node[] = [];\n\n    tips_title_label: Label = null;\n    tips_xipai_label: Label = null;\n    tips_chehui_label: Label = null;\n    tips_addtime_label: Label = null;\n    tips_toushi_label: Label = null;\n    tips_music_label: Label = null;\n    tips_sound_label: Label = null;\n    tips_music_node: Node = null;\n    tips_sound_node: Node = null;\n    gameContinueBtn: Node = null;\n    gameRestBtn: Node = null;\n    gameNextBtn: Node = null;\n\n    isCanClick = false;         //是否可以点击\n    desktopItems = [];          //桌面麻将\n    desktopCuritem = 0;         //当前数量\n    randomIndex = 0;            //当前随机牌索引\n    desktopItemCount = 0;\n    time = 60;\n    allTime = this.time;\n    gameState = GAMESTATE.game_start;\n\n    tabItemPos = [];    //物品栏坐标\n    tabItem: Node[] = [] //物品栏\n\n    onLoad() {\n        console.log('初始化游戏类');\n        let frame = this.gameTipsNode.getChildByName('frame');\n        this.tips_title_label = frame.getChildByName('tips_title_label').getComponent(Label);\n        this.tips_xipai_label = frame.getChildByName('tips_xipai_label').getComponent(Label);\n        this.tips_chehui_label = frame.getChildByName('tips_chehui_label').getComponent(Label);\n        this.tips_addtime_label = frame.getChildByName('tips_addtime_label').getComponent(Label);\n        this.tips_toushi_label = frame.getChildByName('tips_toushi_label').getComponent(Label);\n        this.tips_music_node = frame.getChildByName('music_label');\n        this.tips_music_label = this.tips_music_node.getChildByName('Button').getChildByName('Label').getComponent(Label);\n        this.tips_sound_node = frame.getChildByName('sound_label');\n        this.tips_sound_label = this.tips_sound_node.getChildByName('Button').getChildByName('Label').getComponent(Label);\n        this.gameContinueBtn = frame.getChildByName('gameContinueBtn');\n        this.gameNextBtn = frame.getChildByName('gameNextBtn');\n        this.gameRestBtn = frame.getChildByName('gameRestBtn');\n        this.node.on('clickmj', this.onClickMj, this);\n        tools.getData();\n        this.updataBtn();\n\n        var self = this;\n        game.on(Game.EVENT_HIDE, function () {\n            self.gameShowTips(GAMETIPS.game_seting);\n            console.log('游戏进入后台')\n        });\n\n        game.on(Game.EVENT_SHOW, function () {\n            console.log('游戏进入前台')\n        });\n    }\n\n    start() {\n\n        for (let i = 0; i < this.tabNodes.length; i++) {\n            let pos = { x: 0, y: 0 };\n            let pos1 = this.tabNodes[i].getPosition();\n            pos.x = pos1.x;\n            pos.y = pos1.y;\n            this.tabItemPos.push(pos)\n        }\n        this.startGame();\n    }\n\n    //开始游戏\n    startGame() {\n        console.log('游戏开始---', tools.level)\n        this.isCanClick = true;\n        this.gameState = GAMESTATE.game_start;\n\n        //清理桌面牌，物品栏\n        this.cleanMj();\n\n        //设置牌数量\n        if (tools.level == 1) {\n            this.desktopItemCount = 24;\n        }\n        else if (tools.level == 2) {\n            this.desktopItemCount = 45;\n        }\n        else {\n            this.desktopItemCount = 45 + (tools.level * 3);\n        }\n\n        tools.cardBackNow = 0;\n        tools.cardBackTotal = tools.level + 2;\n\n        //设置关卡时间，当前牌的数量+30S\n        this.setLevelTime(this.desktopItemCount + 10);\n\n        //隐藏 提示面板，开始界面\n        this.gameTipsNode.active = false;\n        gameStart.Instance.hide();\n\n        //更新按钮状态\n        this.updataBtn();\n\n        //随机发牌动画\n        tools.randomMjAnim();\n\n        //开始发牌\n        this.initDesktopMj();\n    }\n\n    //设置关卡时间\n    setLevelTime(time: number) {\n        this.allTime = time;\n        this.time = this.allTime;\n        this.timeLabel.string = '第' + tools.level + '关 ' + '倒计时:' + this.time + 's';\n        this.timeProgressBar.progress = this.time / this.allTime;\n    }\n\n    //清理桌面牌，物品栏\n    cleanMj() {\n        this.node.destroyAllChildren();\n        this.desktopItems = [];\n        this.tabItem = [];\n    }\n\n\n\n    //按钮点击事件\n    onBtnClick(event: Event, customEventData: string) {\n\n        if (customEventData == 'gameMusic') //音乐\n        {\n            if (tools.gameMusic) {\n                AudioMgr.Instance.pauseBgm();\n                tools.gameMusic = false;\n                this.tips_music_label.string = '关';\n            }\n            else {\n                AudioMgr.Instance.resumeBgm();\n                tools.gameMusic = true;\n                this.tips_music_label.string = '开';\n            }\n        }\n        else if (customEventData == 'gameSound') //音效\n        {\n            if (tools.gameSound) {\n                AudioMgr.Instance.setMenu(false);\n                tools.gameSound = false;\n                this.tips_sound_label.string = '关';\n            }\n            else {\n                AudioMgr.Instance.setMenu(true);\n                tools.gameSound = true;\n                this.tips_sound_label.string = '开';\n            }\n        }\n        else if (customEventData == 'gameSetingBtn') //设置按钮\n        {\n            tools.playSound(SOUND.click_sound);\n            if (this.gameState == GAMESTATE.game_start) return;\n            this.gameShowTips(GAMETIPS.game_seting);\n        }\n        else if (customEventData == 'gameContinue') //继续游戏\n        {\n            tools.playSound(SOUND.click_sound);\n            this.contiuneGame();\n        }\n        else if (customEventData == 'gameRest') //重新开始\n        {\n            tools.playSound(SOUND.click_sound);\n            this.startGame();\n        }\n        else if (customEventData == 'gameNext') //下一关\n        {\n            tools.playSound(SOUND.click_sound);\n            this.startGame();\n        }\n        else if (customEventData == 'gameBack')  //返回到开始界面\n        {\n            tools.playSound(SOUND.click_sound);\n            gameStart.Instance.setLevelLabel(tools.level);\n            gameStart.Instance.show();\n            this.unscheduleAllCallbacks();\n            this.node.parent.destroy();\n        }\n        else if (customEventData == 'xipai')     //洗牌\n        {\n            if (tools.xiPai > 0) {\n                this.xiPai();\n                this.updataBtn();\n            }\n        }\n        else if (customEventData == 'chehui')     //撤回\n        {\n            if (tools.cheHui > 0) {\n                this.cheHui();\n                this.updataBtn();\n            }\n        }\n        else if (customEventData == 'addtime')     //加时\n        {\n            if (tools.addTime > 0) {\n                this.addTime();\n                this.updataBtn();\n            }\n        }\n        else if (customEventData == 'toushi')     //透视\n        {\n            if (tools.touShi > 0) {\n                this.touShi();\n                this.setBtnState('gameToushiBtn', false, '透视X' + tools.touShi);\n            }\n        }\n        else if (customEventData == 'music')     //音乐\n        {\n            if (tools.music) {\n                tools.music = false;\n                AudioMgr.Instance.pauseBgm();\n                let label = this.node.parent.getChildByName('gameMusicBtn').getChildByName('Label').getComponent(Label);\n                label.string = '音乐❌'\n            }\n            else {\n                tools.music = true;\n                AudioMgr.Instance.resumeBgm();\n                let label = this.node.parent.getChildByName('gameMusicBtn').getChildByName('Label').getComponent(Label);\n                label.string = '音乐✔'\n            }\n        }\n    }\n\n    //洗牌\n    xiPai() {\n        tools.xiPai--;\n        this.unschedule(this.countdown);\n        var self = this;\n        for (let i = 0; i < this.desktopItems.length; i++) {\n            this.desktopItems[i].active = false;\n        }\n        for (let i = 0; i < this.desktopItems.length; i++) {\n            let desktopScript = this.desktopItems[i].getComponent(\"mjcard\");\n            tween(this.node)\n                .delay(i * 0.04)\n                .call(() => {\n                    tools.playSound(SOUND.sendCard_sound);\n                    if (i == this.desktopItems.length - 1) {\n                        desktopScript.playAnimation(tools.animType, () => {\n                            self.refreshDeaktopMj();\n                            console.log('发牌完毕---', self.desktopCuritem);\n                            self.schedule(self.countdown, 1)\n                        })\n                    }\n                    else {\n                        desktopScript.playAnimation(tools.animType, null);\n                    }\n                })\n                .start()\n        }\n    }\n\n    //撤回按钮\n    cheHui() {\n        if (this.tabItem.length <= 0) return;\n        tools.playSound(SOUND.click_sound);\n        let index = this.tabItem.length;\n        let item = this.tabItem[index - 1];\n        let mjcard = item.getComponent('mjcard') as mjcard;\n        mjcard.setInsterEndPos(new Vec3(0, 0, 0));\n        mjcard.setCanClick(true);\n        var self = this;\n        let t1 = tween(item).to(0.2, { position: new Vec3(mjcard.sPos.x, mjcard.sPos.y, 0) })\n        let t2 = tween(item).call(() => {\n            mjcard.restSibingIndex();\n            self.desktopItems.push(item);\n            self.refreshDeaktopMj();\n        });\n        tween(item).sequence(t1, t2).start()\n        this.tabItem.pop();\n        tools.cheHui--;\n    }\n\n    //加时按钮\n    addTime() {\n        if (tools.addTime <= 0) return;\n        this.time = this.time + tools.addTime;\n        this.allTime = this.time;\n        this.timeLabel.string = '第' + tools.level + '关 ' + '倒计时:' + this.time + 's';\n        this.timeProgressBar.progress = this.time / this.allTime;\n        tools.addTime = 0;\n        tools.playSound(SOUND.start_sound);\n    }\n\n    //透视按钮\n    touShi() {\n        if (tools.touShi <= 0) return;\n        tools.touShi--;\n        tools.playSound(SOUND.click_sound);\n        for (let i = 0; i < this.desktopItems.length; i++) {\n            let mjcard = this.desktopItems[i].getComponent('mjcard') as mjcard;\n            mjcard.setTouShi();\n        }\n\n    }\n\n    onClickMj(node: Node) {\n        if (this.isCanClick == false) {\n            console.log('动画为执行完毕，不可点击---');\n            return;\n        }\n        this.isCanClick = false;\n        //是否可以插入\n        if (this.tabItem.length >= 7)  //不可以插入,游戏结束\n        {\n            console.log('格子已经满了---游戏结束');\n            //this.gameShowTips(1);\n            return;\n        }\n        tools.playSound(SOUND.click_sound);\n        //可以插入\n        this.insertItem(node, insertCallBack);\n\n        //插入回调，删除桌面麻将\n        var self = this;\n        function insertCallBack() {\n            self.deleteDesktopItems(node);\n            //判断物品栏是否可以消除\n            let index = self.isTabCanDelete(node);\n            //console.log('可以消除的下标---', index);\n            if (index.length < 3) {\n                self.refreshDeaktopMj();\n                self.updataBtn();\n                if (self.tabItem.length == 7) {\n                    self.gameShowTips(GAMETIPS.gmae_fail);\n                    console.log('游戏结束---');\n                }\n                self.isCanClick = true;\n                return;\n            }\n            //开始执行物品栏消除动画\n            self.deleteTabAnima(index, function () {\n                tools.playSound(SOUND.clear_sound);\n                self.tabItem.splice(index[2], 1);\n                self.tabItem.splice(index[1], 1);\n                self.tabItem.splice(index[0], 1);\n                self.refreshDeaktopMj();\n                //console.log('消除回调---')\n                self.time += 2;\n                self.restTopAnima()\n            })\n        }\n    }\n\n    update(deltaTime: number) {\n\n    }\n\n    initDesktopMj() {\n        this.desktopCuritem = 0;\n        this.randomIndex = tools.getRandomMjIndex();\n        console.log('开始发牌---', this.desktopItemCount);\n        for (let i = 0; i < this.desktopItemCount; i++) {\n            // i == this.desktopItemCount - 1 ? this.createDesktopMj(true) : this.createDesktopMj(false);\n            tween(this.node)\n                .delay(i * 0.04)\n                .call(() => { i == this.desktopItemCount - 1 ? this.createDesktopMj(true) : this.createDesktopMj(false); })\n                .start()\n        }\n    }\n\n    //倒计时\n    countdown() {\n        if (this.time === 0) {\n            this.unschedule(this.countdown)\n            this.gameShowTips(GAMETIPS.gmae_fail);\n        } else {\n            this.time--;\n            if (this.time < 10) {\n                //AudioManager.inst.playOneShot(main.instant.btTimeMusic);\n                tools.playSound(SOUND.time_sound);\n            }\n            this.timeLabel.string = '第' + tools.level + '关 ' + '倒计时:' + this.time + 's';\n            this.timeProgressBar.progress = this.time / this.allTime;\n        }\n    }\n\n    //随机创建麻将\n    createDesktopMj(refresh) {\n        //发牌\n        if (this.desktopCuritem % 3 == 0) this.randomIndex = tools.getRandomMjIndex();\n        let mj = instantiate(this.mycard_prefab);\n        mj.parent = this.node;\n        var mycard = mj.getComponent(\"mjcard\") as mjcard;\n        this.desktopItems.push(mj);\n        var self = this;\n        mycard.initMj(this.randomIndex, this.desktopItems.length, tools.animType, function () {\n            tools.playSound(SOUND.sendCard_sound);\n            if (refresh) {\n                self.refreshDeaktopMj();\n                self.gameState = GAMESTATE.game_inGame;\n                console.log('发牌完毕---', self.desktopCuritem);\n                self.schedule(self.countdown, 1)\n            }\n        });\n        this.desktopCuritem += 1;\n    }\n\n    //刷新麻将状态\n    refreshDeaktopMj() {\n        for (let i = 0; i < this.desktopItems.length; i++) {\n            let itemsXJ = [];\n            for (let j = 0; j < this.desktopItems.length; j++) {\n                let pos1 = this.desktopItems[i].getPosition();\n                let pos2 = this.desktopItems[j].getPosition();\n                let rect1 = new Rect(pos1.x, pos1.y, 90, 120);\n                let rect2 = new Rect(pos2.x, pos2.y, 90, 120);\n                if (Intersection2D.rectRect(rect1, rect2)) {\n                    itemsXJ.push(this.desktopItems[j]);\n                }\n            }\n            if (itemsXJ.length < 1) return;\n            //去除数组相同的麻将\n            let itemsXJ1 = Array.from(new Set(itemsXJ));\n            //获取数组最大的麻将\n            let maxNodeItem = itemsXJ1.reduce((a, b) => (a.getSiblingIndex() > b.getSiblingIndex() ? a : b));\n            //设置麻将渲染层级\n            for (let i = 0; i < itemsXJ1.length; i++) {\n                let mjscrpit = itemsXJ1[i].getComponent(\"mjcard\");\n                mjscrpit.interaction = false;\n            }\n            let mjscrpit = maxNodeItem.getComponent(\"mjcard\");\n            mjscrpit.interaction = true;\n        }\n    }\n\n    //删除桌面麻将\n    deleteDesktopItems(mjNode) {\n        let mjscrpit = mjNode.getComponent(\"mjcard\");\n        for (let i = 0; i < this.desktopItems.length; i++) {\n            let desktopScript = this.desktopItems[i].getComponent(\"mjcard\");\n            if (mjscrpit.cardId == desktopScript.cardId) {\n                this.desktopItems.splice(i, 1);\n                //console.log('删除桌面成功---', this.desktopItems);\n                return;\n            }\n        }\n    }\n\n    //判断是否可以消除,返回消除下标数组\n    isTabCanDelete(node: Node) {\n        let tempIndex = [];\n        //判断否可以消除\n        for (let i = 0; i < this.tabItem.length; i++) {\n            if (this.tabItem[i].name == node.name) {\n                tempIndex.push(i);\n            }\n        }\n        if (tempIndex.length != 3) tempIndex = [];\n        return tempIndex;\n    }\n\n    //插入到物品栏\n    insertItem(node: Node, callback) {\n\n        this.tabItemPos = [];\n        for (let i = 0; i < this.tabNodes.length; i++) {\n            let pos = { x: 0, y: 0 };\n            let pos1 = this.tabNodes[i].getPosition();\n            pos.x = pos1.x;\n            pos.y = pos1.y;\n            this.tabItemPos.push(pos)\n        }\n        let mjcard = node.getComponent('mjcard') as mjcard;\n        mjcard.restCard();\n        this.tabItem.push(node);\n        //console.log('插入成功---');\n        let index = this.tabItem.length - 1;\n        mjcard.setInsterEndPos(new Vec3(this.tabItemPos[index].x, this.tabItemPos[index].y, 0));\n        mjcard.setCanClick(false);\n        let t1 = tween(node).to(0.2, { position: new Vec3(this.tabItemPos[index].x, this.tabItemPos[index].y, 0) })\n        let t2 = tween(node).call(() => {\n            callback()\n        });\n        node.setSiblingIndex(1000);\n        tween(node).sequence(t1, t2).start()\n    }\n\n    //消除物品栏动画\n    deleteTabAnima(index, callback) {\n        let node2 = this.tabItem[index[2]];\n        let node1 = this.tabItem[index[1]];\n        let node0 = this.tabItem[index[0]];\n        tween(node2)\n            .delay(0.1)\n            .show()\n            .delay(0.1)\n            .hide()\n            .union()\n            .repeat(2)\n            .removeSelf()\n            .start();\n        tween(node1)\n            .delay(0.1)\n            .show()\n            .delay(0.1)\n            .hide()\n            .union()\n            .repeat(2)\n            .removeSelf()\n            .start();\n        tween(node0)\n            .delay(0.1)\n            .show()\n            .delay(0.1)\n            .hide()\n            .union()\n            .repeat(2)\n            .removeSelf()\n            .call(callback())\n            .start();\n    }\n\n    //整理物品栏\n    restTopAnima() {\n        let self = this;\n        if (this.tabItem.length == 0) {\n            self.isCanClick = true;\n        }\n        for (let i = 0; i < this.tabItem.length; i++) {\n            if (i == this.tabItem.length - 1) {\n                tween(this.tabItem[i])\n                    .delay(0.3)\n                    .show()\n                    .to(0.3, { position: new Vec3(this.tabItemPos[i].x, this.tabItemPos[i].y, 0) })\n                    .call(() => {\n                        self.isCanClick = true;\n                    })\n                    .start();\n\n            }\n            else {\n                tween(this.tabItem[i])\n                    .delay(0.3)\n                    .show()\n                    .to(0.3, { position: new Vec3(this.tabItemPos[i].x, this.tabItemPos[i].y, 0) })\n                    .start();\n            }\n        }\n        //成功过关\n        if (this.desktopItems.length == 0) {\n            this.gameShowTips(GAMETIPS.game_success);\n        }\n    }\n\n    //继续游戏\n    contiuneGame() {\n        tools.playSound(SOUND.click_sound);\n        this.gameTipsNode.active = false;\n        this.schedule(this.countdown, 1);\n        this.isCanClick = true;\n    }\n\n    //显示:过关成功，失败，提示 \n    gameShowTips(typeId) {\n\n        this.unschedule(this.countdown);\n\n        if (typeId == GAMETIPS.game_hide) //隐藏面板\n        {\n            this.gameTipsNode.active = false;\n        }\n        else if (typeId == GAMETIPS.game_seting) //设置面板\n        {\n            this.gameTipsNode.active = true;\n            this.tips_title_label.string = '菜  单';\n            this.tips_music_node.active = true;\n            this.tips_sound_node.active = true;\n            this.gameContinueBtn.active = true;\n            this.gameRestBtn.active = false;\n            this.gameNextBtn.active = false;\n            this.tips_xipai_label.node.active = false;\n            this.tips_chehui_label.node.active = false;\n            this.tips_addtime_label.node.active = false;\n            this.tips_toushi_label.node.active = false;\n        }\n        else if (typeId == GAMETIPS.gmae_fail) //失败面板\n        {\n            tools.playSound(SOUND.gameLost_sound);\n            this.isCanClick = false;\n            this.gameState = GAMESTATE.game_end;\n            this.gameTipsNode.active = true;\n            this.tips_title_label.string = '闯关失败，再接再厉!'\n            this.gameContinueBtn.active = false;\n            this.gameRestBtn.active = true;\n            this.gameNextBtn.active = false;\n            this.tips_xipai_label.node.active = true;\n            this.tips_chehui_label.node.active = true;\n            this.tips_addtime_label.node.active = true;\n            this.tips_toushi_label.node.active = true;\n            this.tips_music_node.active = false;\n            this.tips_sound_node.active = false;\n            tools.saveLevel();\n            tools.savaData();\n            this.updataBtn();\n            this.tips_xipai_label.string = '洗 牌: X ' + tools.xiPai;\n            this.tips_chehui_label.string = '撤 回: X ' + tools.cheHui;\n            this.tips_addtime_label.string = '加 时: ' + tools.addTime + 's';\n            this.tips_toushi_label.string = '透 视: X ' + tools.touShi;\n        }\n        else if (typeId == GAMETIPS.game_success) //成功面板\n        {\n            tools.playSound(SOUND.gameWin_sound);\n            this.isCanClick = false;\n            this.gameState = GAMESTATE.game_end;\n            this.gameTipsNode.active = true;\n            this.tips_title_label.string = '恭喜，闯关成功!'\n            this.gameContinueBtn.active = false;\n            this.gameRestBtn.active = false;\n            this.gameNextBtn.active = true;\n            tools.level += 1;       //当前游戏关卡等级\n            tools.addTime += 10;\n            tools.saveLevel();\n            this.setBtnState('gameAddTimeBtn', true, '加时' + tools.addTime + 's');\n            tools.savaData();\n            this.updataBtn();\n            tools.xiPai++;\n            tools.cheHui++;\n            tools.touShi++;\n            this.tips_xipai_label.string = '洗 牌: X ' + tools.xiPai;\n            this.tips_chehui_label.string = '撤 回: X ' + tools.cheHui;\n            this.tips_addtime_label.string = '加 时: ' + tools.addTime + 's';\n            this.tips_toushi_label.string = '透 视: X ' + tools.touShi;\n            this.tips_xipai_label.node.active = true;\n            this.tips_chehui_label.node.active = true;\n            this.tips_addtime_label.node.active = true;\n            this.tips_toushi_label.node.active = true;\n            this.tips_music_node.active = false;\n            this.tips_sound_node.active = false;\n        }\n    }\n\n    //更新道具按钮\n    updataBtn() {\n        if (this.gameState == GAMESTATE.game_end) {\n            this.setBtnState('gameXiPaiBtn', false);\n            this.setBtnState('gameCheHuiBtn', false);\n            this.setBtnState('gameAddTimeBtn', false);\n            this.setBtnState('gameToushiBtn', false);\n            this.setBtnState('gameCheHuiBtn', false);\n        }\n        else {\n            //洗牌按钮\n            if (tools.xiPai <= 0) {\n                this.setBtnState('gameXiPaiBtn', false, '洗牌X0');\n            }\n            else {\n                this.setBtnState('gameXiPaiBtn', true, '洗牌X' + tools.xiPai);\n            }\n            //撤回按钮\n            if (tools.cheHui <= 0 || this.tabItem.length <= 0) {\n                this.setBtnState('gameCheHuiBtn', false, '撤回X' + tools.cheHui);\n            }\n            else {\n                this.setBtnState('gameCheHuiBtn', true, '撤回X' + tools.cheHui);\n            }\n            //加时按钮\n            if (tools.addTime <= 0) {\n                this.setBtnState('gameAddTimeBtn', false, '加时0s');\n            }\n            else {\n                this.setBtnState('gameAddTimeBtn', true, '加时' + tools.addTime + 's');\n            }\n            //透视按钮\n            if (tools.touShi <= 0) {\n                this.setBtnState('gameToushiBtn', false, '透视X0');\n            }\n            else {\n                this.setBtnState('gameToushiBtn', true, '透视X' + tools.touShi);\n            }\n\n        }\n        tools.savaData();\n    }\n\n    setBtnState(bttName: string, enable: boolean, btnText: string | null = null) {\n        let node = this.node.parent.getChildByName(bttName);\n        let label = node.getChildByName('Label').getComponent(Label);\n        if (btnText != null) label.string = btnText;\n        if (enable) {\n            node.getComponent(Sprite).color = color(255, 255, 255, 255);\n            node.getComponent(Button).enabled = true;\n        }\n        else {\n            node.getComponent(Sprite).color = color(255, 255, 255, 128);\n            node.getComponent(Button).enabled = false;\n        }\n    }\n}\n\n"]}