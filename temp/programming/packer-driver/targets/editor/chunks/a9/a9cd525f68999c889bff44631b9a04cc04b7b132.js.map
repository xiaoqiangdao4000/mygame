{"version":3,"sources":["file:///C:/Users/zzx/Desktop/mygame/assets/scripts/gameLanch.ts"],"names":["_decorator","Component","instantiate","Label","Sprite","tween","resMgr","tools","ccclass","property","gameLauch","loadingSprite","loadingLabel","onLoad","Instance","console","log","destroy","node","addComponent","start","startLoad","getChildByName","getComponent","fillRange","string","preLoadResPkg","resPkg","loadingResCallBack","delay","call","enterStartScene","now","total","hideLoading","prefab","getAsset","gameStart","parent","loadingNode","active"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAqBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AACjEC,MAAAA,M,iBAAAA,M;;AACFC,MAAAA,K;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;2BAGjBU,S,WADZF,OAAO,CAAC,WAAD,C,2BAAR,MACaE,SADb,SAC+BT,SAD/B,CACyC;AAAA;AAAA;AAAA,eAGrCU,aAHqC;AAGb;AAHa,eAIrCC,YAJqC;AAAA;;AAIb;AAGxBC,QAAAA,MAAM,GAAG;AACL,cAAIH,SAAS,CAACI,QAAV,KAAuB,IAA3B,EAAiC;AAC7BC,YAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAN,YAAAA,SAAS,CAACI,QAAV,GAAqB,IAArB;AACH,WAHD,MAIK;AACD,iBAAKG,OAAL;AACA;AACH,WARI,CAUL;AAEA;;;AACA,eAAKC,IAAL,CAAUC,YAAV;AAAA;AAAA;AACH;;AAEDC,QAAAA,KAAK,GAAG;AACJ;AACA,eAAKC,SAAL;AACH,SA1BoC,CA4BrC;;;AACAA,QAAAA,SAAS,GAAG;AACR,eAAKV,aAAL,GAAqB,KAAKO,IAAL,CAAUI,cAAV,CAAyB,aAAzB,EAAwCA,cAAxC,CAAuD,UAAvD,EAAmEC,YAAnE,CAAgFnB,MAAhF,CAArB;AACA,eAAKQ,YAAL,GAAoB,KAAKM,IAAL,CAAUI,cAAV,CAAyB,aAAzB,EAAwCA,cAAxC,CAAuD,YAAvD,EAAqEC,YAArE,CAAkFpB,KAAlF,CAApB;AACA,eAAKQ,aAAL,CAAmBa,SAAnB,GAA+B,CAA/B;AACA,eAAKZ,YAAL,CAAkBa,MAAlB,GAA2B,WAA3B,CAJQ,CAMR;;AACA;AAAA;AAAA,gCAAOX,QAAP,CAAgBY,aAAhB,CAA8B;AAAA;AAAA,8BAAMC,MAApC,EAA4C,KAAKC,kBAAjD,EAAqE,MAAM;AACvE;AACAvB,YAAAA,KAAK,CAAC,KAAKa,IAAN,CAAL,CACKW,KADL,CACW,GADX,EAEKC,IAFL,CAEU,MAAM;AACRpB,cAAAA,SAAS,CAACI,QAAV,CAAmBiB,eAAnB;AACH,aAJL,EAIOX,KAJP;AAMH,WARD;AASH,SA7CoC,CA+CrC;;;AACAQ,QAAAA,kBAAkB,CAACI,GAAD,EAAMC,KAAN,EAAa;AAC3BvB,UAAAA,SAAS,CAACI,QAAV,CAAmBF,YAAnB,CAAgCa,MAAhC,GAAyC,UAAUO,GAAV,GAAgB,GAAhB,GAAsBC,KAA/D;AACAvB,UAAAA,SAAS,CAACI,QAAV,CAAmBH,aAAnB,CAAiCa,SAAjC,GAA6CQ,GAAG,GAAGC,KAAnD;AACH,SAnDoC,CAqDrC;;;AACAF,QAAAA,eAAe,GAAG;AAEd;AACA,eAAKG,WAAL,GAHc,CAKd;;AACA,cAAIC,MAAM,GAAG;AAAA;AAAA,gCAAOrB,QAAP,CAAgBsB,QAAhB,CAAyB,SAAzB,EAAoC,WAApC,CAAb;AACA,cAAIC,SAAS,GAAGnC,WAAW,CAACiC,MAAD,CAA3B;AACAE,UAAAA,SAAS,CAACC,MAAV,GAAmB,KAAKpB,IAAxB;AAEH,SAhEoC,CAkErC;;;AACAgB,QAAAA,WAAW,GAAG;AACV,cAAIK,WAAW,GAAG,KAAKrB,IAAL,CAAUI,cAAV,CAAyB,aAAzB,CAAlB;AACAiB,UAAAA,WAAW,CAACC,MAAZ,GAAqB,KAArB;AACH;;AAtEoC,O,UAC9B1B,Q,GAAsB,I","sourcesContent":["import { _decorator, Component, instantiate, Label, Node, Prefab, Sprite, tween } from 'cc';\r\nimport { resMgr } from './resMgr';\r\nimport tools from './tools';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('gameLauch')\r\nexport class gameLauch extends Component {\r\n    static Instance: gameLauch = null\r\n\r\n    loadingSprite: Sprite;  //进度条\r\n    loadingLabel: Label;    //进度条文字\r\n\r\n\r\n    onLoad() {\r\n        if (gameLauch.Instance === null) {\r\n            console.log('初始化gameLauch单列!')\r\n            gameLauch.Instance = this;\r\n        }\r\n        else {\r\n            this.destroy();\r\n            return;\r\n        }\r\n\r\n        //初始化游戏框架：资源管理模块，网络模块...\r\n\r\n        //资源管理系统\r\n        this.node.addComponent(resMgr);\r\n    }\r\n\r\n    start() {\r\n        //资源监测更新加载\r\n        this.startLoad();\r\n    }\r\n\r\n    //先加载资源\r\n    startLoad() {\r\n        this.loadingSprite = this.node.getChildByName('gameLoading').getChildByName('loading1').getComponent(Sprite);\r\n        this.loadingLabel = this.node.getChildByName('gameLoading').getChildByName('loadingStr').getComponent(Label);\r\n        this.loadingSprite.fillRange = 0;\r\n        this.loadingLabel.string = '资源加载:开始加载';\r\n\r\n        //加载资源\r\n        resMgr.Instance.preLoadResPkg(tools.resPkg, this.loadingResCallBack, () => {\r\n            //资源加载完成回调\r\n            tween(this.node)\r\n                .delay(0.3)\r\n                .call(() => {\r\n                    gameLauch.Instance.enterStartScene();\r\n                }).start();\r\n\r\n        });\r\n    }\r\n\r\n    //资源加载进度\r\n    loadingResCallBack(now, total) {\r\n        gameLauch.Instance.loadingLabel.string = '资源加载:' + now + '/' + total;\r\n        gameLauch.Instance.loadingSprite.fillRange = now / total;\r\n    }\r\n\r\n    //进入开始界面\r\n    enterStartScene() {\r\n\r\n        //隐藏资源加载界面\r\n        this.hideLoading();\r\n\r\n        //加载开始界面\r\n        let prefab = resMgr.Instance.getAsset('prefabs', 'gameStart') as Prefab;\r\n        let gameStart = instantiate(prefab);\r\n        gameStart.parent = this.node;\r\n\r\n    }\r\n\r\n    //隐藏资源加载界面\r\n    hideLoading() {\r\n        let loadingNode = this.node.getChildByName('gameLoading');\r\n        loadingNode.active = false;\r\n    }\r\n\r\n\r\n}\r\n\r\n"]}