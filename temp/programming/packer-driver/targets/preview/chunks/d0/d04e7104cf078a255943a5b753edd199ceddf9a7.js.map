{"version":3,"sources":["file:///Users/zzx/Desktop/mygame/assets/scripts/gameLanch.ts"],"names":["_decorator","Component","instantiate","Label","Sprite","resMgr","tools","ccclass","property","gameLauch","loadingSprite","loadingLabel","onLoad","Instance","console","log","destroy","node","addComponent","start","startLoad","getChildByName","getComponent","fillRange","string","preLoadResPkg","resPkg","loadingResCallBack","enterStartScene","now","total","hideLoading","prefab","getAsset","gameStart","parent","loadingNode","active"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAqBC,MAAAA,M,OAAAA,M;;AACzDC,MAAAA,M,iBAAAA,M;;AACFC,MAAAA,K;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;2BAGjBS,S,WADZF,OAAO,CAAC,WAAD,C,2BAAR,MACaE,SADb,SAC+BR,SAD/B,CACyC;AAAA;AAAA;AAAA,eAGrCS,aAHqC;AAGb;AAHa,eAIrCC,YAJqC;AAAA;;AAIb;AAGxBC,QAAAA,MAAM,GAAG;AACL,cAAIH,SAAS,CAACI,QAAV,KAAuB,IAA3B,EAAiC;AAC7BC,YAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAN,YAAAA,SAAS,CAACI,QAAV,GAAqB,IAArB;AACH,WAHD,MAIK;AACD,iBAAKG,OAAL;AACA;AACH,WARI,CAUL;AAEA;;;AACA,eAAKC,IAAL,CAAUC,YAAV;AAAA;AAAA;AACH;;AAEDC,QAAAA,KAAK,GAAG;AACJ;AACA,eAAKC,SAAL;AACH,SA1BoC,CA4BrC;;;AACAA,QAAAA,SAAS,GAAG;AACR,eAAKV,aAAL,GAAqB,KAAKO,IAAL,CAAUI,cAAV,CAAyB,aAAzB,EAAwCA,cAAxC,CAAuD,UAAvD,EAAmEC,YAAnE,CAAgFlB,MAAhF,CAArB;AACA,eAAKO,YAAL,GAAoB,KAAKM,IAAL,CAAUI,cAAV,CAAyB,aAAzB,EAAwCA,cAAxC,CAAuD,YAAvD,EAAqEC,YAArE,CAAkFnB,KAAlF,CAApB;AACA,eAAKO,aAAL,CAAmBa,SAAnB,GAA+B,CAA/B;AACA,eAAKZ,YAAL,CAAkBa,MAAlB,GAA2B,WAA3B,CAJQ,CAMR;;AACA;AAAA;AAAA,gCAAOX,QAAP,CAAgBY,aAAhB,CAA8B;AAAA;AAAA,8BAAMC,MAApC,EAA4C,KAAKC,kBAAjD,EAAqE,MAAM;AACvE;AACA,iBAAKC,eAAL;AACH,WAHD;AAIH,SAxCoC,CA0CrC;;;AACAD,QAAAA,kBAAkB,CAACE,GAAD,EAAMC,KAAN,EAAa;AAC3BrB,UAAAA,SAAS,CAACI,QAAV,CAAmBF,YAAnB,CAAgCa,MAAhC,GAAyC,UAAUK,GAAV,GAAgB,GAAhB,GAAsBC,KAA/D;AACArB,UAAAA,SAAS,CAACI,QAAV,CAAmBH,aAAnB,CAAiCa,SAAjC,GAA6CM,GAAG,GAAGC,KAAnD;AACH,SA9CoC,CAgDrC;;;AACAF,QAAAA,eAAe,GAAG;AAEd;AACA,eAAKG,WAAL,GAHc,CAKd;;AACA,cAAIC,MAAM,GAAG;AAAA;AAAA,gCAAOnB,QAAP,CAAgBoB,QAAhB,CAAyB,SAAzB,EAAoC,WAApC,CAAb;AACA,cAAIC,SAAS,GAAGhC,WAAW,CAAC8B,MAAD,CAA3B;AACAE,UAAAA,SAAS,CAACC,MAAV,GAAmB,KAAKlB,IAAxB;AAEH,SA3DoC,CA6DrC;;;AACAc,QAAAA,WAAW,GAAG;AACV,cAAIK,WAAW,GAAG,KAAKnB,IAAL,CAAUI,cAAV,CAAyB,aAAzB,CAAlB;AACAe,UAAAA,WAAW,CAACC,MAAZ,GAAqB,KAArB;AACH;;AAjEoC,O,UAC9BxB,Q,GAAsB,I","sourcesContent":["import { _decorator, Component, instantiate, Label, Node, Prefab, Sprite } from 'cc';\nimport { resMgr } from './resMgr';\nimport tools from './tools';\nconst { ccclass, property } = _decorator;\n\n@ccclass('gameLauch')\nexport class gameLauch extends Component {\n    static Instance: gameLauch = null\n\n    loadingSprite: Sprite;  //进度条\n    loadingLabel: Label;    //进度条文字\n\n\n    onLoad() {\n        if (gameLauch.Instance === null) {\n            console.log('初始化gameLauch单列!')\n            gameLauch.Instance = this;\n        }\n        else {\n            this.destroy();\n            return;\n        }\n\n        //初始化游戏框架：资源管理模块，网络模块...\n\n        //资源管理系统\n        this.node.addComponent(resMgr);\n    }\n\n    start() {\n        //资源监测更新加载\n        this.startLoad();\n    }\n\n    //先加载资源\n    startLoad() {\n        this.loadingSprite = this.node.getChildByName('gameLoading').getChildByName('loading1').getComponent(Sprite);\n        this.loadingLabel = this.node.getChildByName('gameLoading').getChildByName('loadingStr').getComponent(Label);\n        this.loadingSprite.fillRange = 0;\n        this.loadingLabel.string = '资源加载:开始加载';\n\n        //加载资源\n        resMgr.Instance.preLoadResPkg(tools.resPkg, this.loadingResCallBack, () => {\n            //资源加载完成回调\n            this.enterStartScene();\n        });\n    }\n\n    //资源加载进度\n    loadingResCallBack(now, total) {\n        gameLauch.Instance.loadingLabel.string = '资源加载:' + now + '/' + total;\n        gameLauch.Instance.loadingSprite.fillRange = now / total;\n    }\n\n    //进入开始界面\n    enterStartScene() {\n\n        //隐藏资源加载界面\n        this.hideLoading();\n\n        //加载开始界面\n        let prefab = resMgr.Instance.getAsset('prefabs', 'gameStart');\n        let gameStart = instantiate(prefab);\n        gameStart.parent = this.node;\n\n    }\n\n    //隐藏资源加载界面\n    hideLoading() {\n        let loadingNode = this.node.getChildByName('gameLoading');\n        loadingNode.active = false;\n    }\n\n\n}\n\n"]}