{"version":3,"sources":["file:///C:/Users/zzx/Desktop/mygame/assets/scripts/mjNode.ts"],"names":["_decorator","Button","color","Component","instantiate","Intersection2D","Label","Node","Prefab","ProgressBar","Rect","Sprite","tween","Vec3","tools","GAMESTATE","GAMETIPS","SOUND","gameStart","AudioMgr","ccclass","property","mjNode","type","tips_title_label","tips_xipai_label","tips_chehui_label","tips_addtime_label","tips_toushi_label","gameContinueBtn","gameRestBtn","gameNextBtn","isCanClick","desktopItems","desktopCuritem","randomIndex","desktopItemCount","time","allTime","gameState","game_start","tabItemPos","tabItem","onLoad","console","log","gameTipsNode","getChildByName","getComponent","node","on","onClickMj","getData","updataBtn","start","i","tabNodes","length","pos","x","y","pos1","getPosition","push","startGame","level","cleanMj","cardBackNow","cardBackTotal","setLevelTime","active","Instance","hide","randomMjAnim","initDesktopMj","timeLabel","string","timeProgressBar","progress","destroyAllChildren","onBtnClick","event","customEventData","playSound","click_sound","contiuneGame","setLevelLabel","show","unscheduleAllCallbacks","parent","destroy","xiPai","cheHui","addTime","touShi","setBtnState","music","pauseBgm","label","resumeBgm","unschedule","countdown","self","desktopScript","delay","call","sendCard_sound","playAnimation","animType","refreshDeaktopMj","schedule","index","item","mjcard","setInsterEndPos","setCanClick","t1","to","position","sPos","t2","restSibingIndex","sequence","pop","start_sound","setTouShi","insertItem","insertCallBack","deleteDesktopItems","isTabCanDelete","gameShowTips","gmae_fail","deleteTabAnima","clear_sound","splice","restTopAnima","update","deltaTime","getRandomMjIndex","createDesktopMj","time_sound","refresh","mj","mycard_prefab","mycard","initMj","game_inGame","itemsXJ","j","pos2","rect1","rect2","rectRect","itemsXJ1","Array","from","Set","maxNodeItem","reduce","a","b","getSiblingIndex","mjscrpit","interaction","cardId","tempIndex","name","callback","restCard","setSiblingIndex","node2","node1","node0","union","repeat","removeSelf","game_success","typeId","spos","epos","game_hide","game_contiune","setPosition","easing","gameLost_sound","game_end","saveLevel","savaData","gameWin_sound","bttName","enable","btnText","enabled"],"mappings":"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","sourcesContent":["import { _decorator, Button, color, Component, instantiate, Intersection2D, Label, Node, Prefab, ProgressBar, Rect, Sprite, tween, Vec3 } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\nimport tools, { GAMESTATE, GAMETIPS, SOUND } from './tools'\r\nimport { gameStart } from './gameStart';\r\nimport { mjcard } from './mjcard';\r\nimport { AudioMgr } from './audioManager';\r\n//const { systemEvent } = cc;\r\n\r\n@ccclass('mjNode')\r\nexport class mjNode extends Component {\r\n\r\n    @property(Prefab)\r\n    mycard_prefab: Prefab | null = null;\r\n\r\n    @property(ProgressBar)\r\n    timeProgressBar: ProgressBar | null = null;\r\n\r\n    @property(Label)\r\n    timeLabel: Label | null = null;\r\n\r\n    @property(Node)\r\n    gameTipsNode: Node | null = null;\r\n\r\n    @property({\r\n        type: [Node]\r\n    })\r\n    tabNodes: Node[] = [];\r\n\r\n    tips_title_label: Label = null;\r\n    tips_xipai_label: Label = null;\r\n    tips_chehui_label: Label = null;\r\n    tips_addtime_label: Label = null;\r\n    tips_toushi_label: Label = null;\r\n    gameContinueBtn: Node = null;\r\n    gameRestBtn: Node = null;\r\n    gameNextBtn: Node = null;\r\n\r\n    static Instance: mjNode = null;\r\n\r\n    isCanClick = false;         //是否可以点击\r\n    desktopItems = [];          //桌面麻将\r\n    desktopCuritem = 0;         //当前数量\r\n    randomIndex = 0;            //当前随机牌索引\r\n    desktopItemCount = 0;\r\n    time = 60;\r\n    allTime = this.time;\r\n    gameState = GAMESTATE.game_start;\r\n\r\n    tabItemPos = [];    //物品栏坐标\r\n    tabItem: Node[] = [] //物品栏\r\n\r\n    onLoad() {\r\n        console.log('初始化游戏类');\r\n        this.tips_title_label = this.gameTipsNode.getChildByName('tips_title_label').getComponent(Label);\r\n        this.tips_xipai_label = this.gameTipsNode.getChildByName('tips_xipai_label').getComponent(Label);\r\n        this.tips_chehui_label = this.gameTipsNode.getChildByName('tips_chehui_label').getComponent(Label);\r\n        this.tips_addtime_label = this.gameTipsNode.getChildByName('tips_addtime_label').getComponent(Label);\r\n        this.tips_toushi_label = this.gameTipsNode.getChildByName('tips_toushi_label').getComponent(Label);\r\n        this.gameContinueBtn = this.gameTipsNode.getChildByName('gameContinueBtn');\r\n        this.gameNextBtn = this.gameTipsNode.getChildByName('gameNextBtn');\r\n        this.gameRestBtn = this.gameTipsNode.getChildByName('gameRestBtn');\r\n        this.node.on('clickmj', this.onClickMj, this);\r\n        tools.getData();\r\n        this.updataBtn();\r\n    }\r\n\r\n    start() {\r\n\r\n        for (let i = 0; i < this.tabNodes.length; i++) {\r\n            let pos = { x: 0, y: 0 };\r\n            let pos1 = this.tabNodes[i].getPosition();\r\n            pos.x = pos1.x;\r\n            pos.y = pos1.y;\r\n            this.tabItemPos.push(pos)\r\n        }\r\n        this.startGame();\r\n    }\r\n\r\n    //开始游戏\r\n    startGame() {\r\n        console.log('游戏开始---', tools.level)\r\n        this.isCanClick = true;\r\n        this.gameState = GAMESTATE.game_start;\r\n\r\n        //清理桌面牌，物品栏\r\n        this.cleanMj();\r\n\r\n        //设置牌数量\r\n        if (tools.level == 1) {\r\n            this.desktopItemCount = 24;\r\n        }\r\n        else if (tools.level == 2) {\r\n            this.desktopItemCount = 45;\r\n        }\r\n        else {\r\n            this.desktopItemCount = 45 + (tools.level * 3);\r\n        }\r\n\r\n        tools.cardBackNow = 0;\r\n        tools.cardBackTotal = tools.level + 2;\r\n\r\n        //设置关卡时间，当前牌的数量+30S\r\n        this.setLevelTime(this.desktopItemCount + 10);\r\n\r\n        //隐藏 提示面板，开始界面\r\n        this.gameTipsNode.active = false;\r\n        gameStart.Instance.hide();\r\n\r\n        //更新按钮状态\r\n        this.updataBtn();\r\n\r\n        //随机发牌动画\r\n        tools.randomMjAnim();\r\n\r\n        //开始发牌\r\n        this.initDesktopMj();\r\n    }\r\n\r\n    //设置关卡时间\r\n    setLevelTime(time: number) {\r\n        this.allTime = time;\r\n        this.time = this.allTime;\r\n        this.timeLabel.string = '第' + tools.level + '关 ' + '倒计时:' + this.time + 's';\r\n        this.timeProgressBar.progress = this.time / this.allTime;\r\n    }\r\n\r\n    //清理桌面牌，物品栏\r\n    cleanMj() {\r\n        this.node.destroyAllChildren();\r\n        this.desktopItems = [];\r\n        this.tabItem = [];\r\n    }\r\n\r\n    //按钮点击事件\r\n    onBtnClick(event: Event, customEventData: string) {\r\n\r\n        // if (customEventData == 'gameStart') // //游戏开始\r\n        // {\r\n        //     this.gameShowTips(GAMETIPS.game_hide);\r\n        // }\r\n        // else \r\n\r\n        if (customEventData == 'gameContiune') //继续游戏\r\n        {\r\n            tools.playSound(SOUND.click_sound);\r\n            this.contiuneGame();\r\n        }\r\n        else if (customEventData == 'gameRest') //重新开始\r\n        {\r\n            tools.playSound(SOUND.click_sound);\r\n            this.startGame();\r\n        }\r\n        else if (customEventData == 'gameNext') //下一关\r\n        {\r\n            tools.playSound(SOUND.click_sound);\r\n            this.startGame();\r\n        }\r\n        else if (customEventData == 'gameBack')  //返回到开始界面\r\n        {\r\n            tools.playSound(SOUND.click_sound);\r\n            gameStart.Instance.setLevelLabel(tools.level);\r\n            gameStart.Instance.show();\r\n            this.unscheduleAllCallbacks();\r\n            this.node.parent.destroy();\r\n        }\r\n        else if (customEventData == 'xipai')     //洗牌\r\n        {\r\n            if (tools.xiPai > 0) {\r\n                this.xiPai();\r\n                this.updataBtn();\r\n            }\r\n        }\r\n        else if (customEventData == 'chehui')     //撤回\r\n        {\r\n            if (tools.cheHui > 0) {\r\n                this.cheHui();\r\n                this.updataBtn();\r\n            }\r\n        }\r\n        else if (customEventData == 'addtime')     //加时\r\n        {\r\n            if (tools.addTime > 0) {\r\n                this.addTime();\r\n                this.updataBtn();\r\n            }\r\n        }\r\n        else if (customEventData == 'toushi')     //透视\r\n        {\r\n            if (tools.touShi > 0) {\r\n                this.touShi();\r\n                this.setBtnState('gameToushiBtn', false, '透视X' + tools.touShi);\r\n            }\r\n        }\r\n        else if (customEventData == 'music')     //音乐\r\n        {\r\n            if (tools.music) {\r\n                tools.music = false;\r\n                AudioMgr.Instance.pauseBgm();\r\n                let label = this.node.parent.getChildByName('gameMusicBtn').getChildByName('Label').getComponent(Label);\r\n                label.string = '音乐❌'\r\n            }\r\n            else {\r\n                tools.music = true;\r\n                AudioMgr.Instance.resumeBgm();\r\n                let label = this.node.parent.getChildByName('gameMusicBtn').getChildByName('Label').getComponent(Label);\r\n                label.string = '音乐✔'\r\n            }\r\n        }\r\n    }\r\n\r\n    //洗牌\r\n    xiPai() {\r\n        tools.xiPai--;\r\n        this.unschedule(this.countdown);\r\n        var self = this;\r\n        for (let i = 0; i < this.desktopItems.length; i++) {\r\n            this.desktopItems[i].active = false;\r\n        }\r\n        for (let i = 0; i < this.desktopItems.length; i++) {\r\n            let desktopScript = this.desktopItems[i].getComponent(\"mjcard\");\r\n            tween(this.node)\r\n                .delay(i * 0.04)\r\n                .call(() => {\r\n                    tools.playSound(SOUND.sendCard_sound);\r\n                    if (i == this.desktopItems.length - 1) {\r\n                        desktopScript.playAnimation(tools.animType, () => {\r\n                            self.refreshDeaktopMj();\r\n                            console.log('发牌完毕---', self.desktopCuritem);\r\n                            self.schedule(self.countdown, 1)\r\n                        })\r\n                    }\r\n                    else {\r\n                        desktopScript.playAnimation(tools.animType, null);\r\n                    }\r\n                })\r\n                .start()\r\n        }\r\n    }\r\n\r\n    //撤回按钮\r\n    cheHui() {\r\n        if (this.tabItem.length <= 0) return;\r\n        tools.playSound(SOUND.click_sound);\r\n        let index = this.tabItem.length;\r\n        let item = this.tabItem[index - 1];\r\n        let mjcard = item.getComponent('mjcard') as mjcard;\r\n        mjcard.setInsterEndPos(new Vec3(0, 0, 0));\r\n        mjcard.setCanClick(true);\r\n        var self = this;\r\n        let t1 = tween(item).to(0.2, { position: new Vec3(mjcard.sPos.x, mjcard.sPos.y, 0) })\r\n        let t2 = tween(item).call(() => {\r\n            mjcard.restSibingIndex();\r\n            self.desktopItems.push(item);\r\n            self.refreshDeaktopMj();\r\n        });\r\n        tween(item).sequence(t1, t2).start()\r\n        this.tabItem.pop();\r\n        tools.cheHui--;\r\n    }\r\n\r\n    //加时按钮\r\n    addTime() {\r\n        if (tools.addTime <= 0) return;\r\n        this.time = this.time + tools.addTime;\r\n        this.allTime = this.time;\r\n        this.timeLabel.string = '第' + tools.level + '关 ' + '倒计时:' + this.time + 's';\r\n        this.timeProgressBar.progress = this.time / this.allTime;\r\n        tools.addTime = 0;\r\n        tools.playSound(SOUND.start_sound);\r\n    }\r\n\r\n    //透视按钮\r\n    touShi() {\r\n        if (tools.touShi <= 0) return;\r\n        tools.touShi--;\r\n        tools.playSound(SOUND.click_sound);\r\n        for (let i = 0; i < this.desktopItems.length; i++) {\r\n            let mjcard = this.desktopItems[i].getComponent('mjcard') as mjcard;\r\n            mjcard.setTouShi();\r\n        }\r\n\r\n    }\r\n\r\n    onClickMj(node: Node) {\r\n        if (this.isCanClick == false) {\r\n            console.log('动画为执行完毕，不可点击---');\r\n            return;\r\n        }\r\n        this.isCanClick = false;\r\n        //是否可以插入\r\n        if (this.tabItem.length >= 7)  //不可以插入,游戏结束\r\n        {\r\n            console.log('格子已经满了---游戏结束');\r\n            //this.gameShowTips(1);\r\n            return;\r\n        }\r\n        tools.playSound(SOUND.click_sound);\r\n        //可以插入\r\n        this.insertItem(node, insertCallBack);\r\n\r\n        //插入回调，删除桌面麻将\r\n        var self = this;\r\n        function insertCallBack() {\r\n            self.deleteDesktopItems(node);\r\n            //判断物品栏是否可以消除\r\n            let index = self.isTabCanDelete(node);\r\n            //console.log('可以消除的下标---', index);\r\n            if (index.length < 3) {\r\n                self.refreshDeaktopMj();\r\n                self.updataBtn();\r\n                if (self.tabItem.length == 7) {\r\n                    self.gameShowTips(GAMETIPS.gmae_fail);\r\n                    console.log('游戏结束---');\r\n                }\r\n                self.isCanClick = true;\r\n                return;\r\n            }\r\n            //开始执行物品栏消除动画\r\n            self.deleteTabAnima(index, function () {\r\n                tools.playSound(SOUND.clear_sound);\r\n                self.tabItem.splice(index[2], 1);\r\n                self.tabItem.splice(index[1], 1);\r\n                self.tabItem.splice(index[0], 1);\r\n                self.refreshDeaktopMj();\r\n                //console.log('消除回调---')\r\n                self.time += 2;\r\n                self.restTopAnima()\r\n            })\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n\r\n    initDesktopMj() {\r\n        this.desktopCuritem = 0;\r\n        this.randomIndex = tools.getRandomMjIndex();\r\n        console.log('开始发牌---', this.desktopItemCount);\r\n        for (let i = 0; i < this.desktopItemCount; i++) {\r\n            // i == this.desktopItemCount - 1 ? this.createDesktopMj(true) : this.createDesktopMj(false);\r\n            tween(this.node)\r\n                .delay(i * 0.04)\r\n                .call(() => { i == this.desktopItemCount - 1 ? this.createDesktopMj(true) : this.createDesktopMj(false); })\r\n                .start()\r\n        }\r\n    }\r\n\r\n    //倒计时\r\n    countdown() {\r\n        if (this.time === 0) {\r\n            this.unschedule(this.countdown)\r\n            this.gameShowTips(GAMETIPS.gmae_fail);\r\n        } else {\r\n            this.time--;\r\n            if (this.time < 10) {\r\n                //AudioManager.inst.playOneShot(main.instant.btTimeMusic);\r\n                tools.playSound(SOUND.time_sound);\r\n            }\r\n            this.timeLabel.string = '第' + tools.level + '关 ' + '倒计时:' + this.time + 's';\r\n            this.timeProgressBar.progress = this.time / this.allTime;\r\n        }\r\n    }\r\n\r\n    //随机创建麻将\r\n    createDesktopMj(refresh) {\r\n        //发牌\r\n        if (this.desktopCuritem % 3 == 0) this.randomIndex = tools.getRandomMjIndex();\r\n        let mj = instantiate(this.mycard_prefab);\r\n        mj.parent = this.node;\r\n        var mycard = mj.getComponent(\"mjcard\") as mjcard;\r\n        this.desktopItems.push(mj);\r\n        var self = this;\r\n        mycard.initMj(this.randomIndex, this.desktopItems.length, tools.animType, function () {\r\n            if (self.desktopCuritem % 2 == 0) tools.playSound(SOUND.sendCard_sound);\r\n            if (refresh) {\r\n                self.refreshDeaktopMj();\r\n                self.gameState = GAMESTATE.game_inGame;\r\n                console.log('发牌完毕---', self.desktopCuritem);\r\n                self.schedule(self.countdown, 1)\r\n            }\r\n        });\r\n        this.desktopCuritem += 1;\r\n    }\r\n\r\n    //刷新麻将状态\r\n    refreshDeaktopMj() {\r\n        for (let i = 0; i < this.desktopItems.length; i++) {\r\n            let itemsXJ = [];\r\n            for (let j = 0; j < this.desktopItems.length; j++) {\r\n                let pos1 = this.desktopItems[i].getPosition();\r\n                let pos2 = this.desktopItems[j].getPosition();\r\n                let rect1 = new Rect(pos1.x, pos1.y, 90, 120);\r\n                let rect2 = new Rect(pos2.x, pos2.y, 90, 120);\r\n                if (Intersection2D.rectRect(rect1, rect2)) {\r\n                    itemsXJ.push(this.desktopItems[j]);\r\n                }\r\n            }\r\n            if (itemsXJ.length < 1) return;\r\n            //去除数组相同的麻将\r\n            let itemsXJ1 = Array.from(new Set(itemsXJ));\r\n            //获取数组最大的麻将\r\n            let maxNodeItem = itemsXJ1.reduce((a, b) => (a.getSiblingIndex() > b.getSiblingIndex() ? a : b));\r\n            //设置麻将渲染层级\r\n            for (let i = 0; i < itemsXJ1.length; i++) {\r\n                let mjscrpit = itemsXJ1[i].getComponent(\"mjcard\");\r\n                mjscrpit.interaction = false;\r\n            }\r\n            let mjscrpit = maxNodeItem.getComponent(\"mjcard\");\r\n            mjscrpit.interaction = true;\r\n        }\r\n    }\r\n\r\n    //删除桌面麻将\r\n    deleteDesktopItems(mjNode) {\r\n        let mjscrpit = mjNode.getComponent(\"mjcard\");\r\n        for (let i = 0; i < this.desktopItems.length; i++) {\r\n            let desktopScript = this.desktopItems[i].getComponent(\"mjcard\");\r\n            if (mjscrpit.cardId == desktopScript.cardId) {\r\n                this.desktopItems.splice(i, 1);\r\n                //console.log('删除桌面成功---', this.desktopItems);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    //判断是否可以消除,返回消除下标数组\r\n    isTabCanDelete(node: Node) {\r\n        let tempIndex = [];\r\n        //判断否可以消除\r\n        for (let i = 0; i < this.tabItem.length; i++) {\r\n            if (this.tabItem[i].name == node.name) {\r\n                tempIndex.push(i);\r\n            }\r\n        }\r\n        if (tempIndex.length != 3) tempIndex = [];\r\n        return tempIndex;\r\n    }\r\n\r\n    //插入到物品栏\r\n    insertItem(node: Node, callback) {\r\n\r\n        this.tabItemPos = [];\r\n        for (let i = 0; i < this.tabNodes.length; i++) {\r\n            let pos = { x: 0, y: 0 };\r\n            let pos1 = this.tabNodes[i].getPosition();\r\n            pos.x = pos1.x;\r\n            pos.y = pos1.y;\r\n            this.tabItemPos.push(pos)\r\n        }\r\n        let mjcard = node.getComponent('mjcard') as mjcard;\r\n        mjcard.restCard();\r\n        this.tabItem.push(node);\r\n        //console.log('插入成功---');\r\n        let index = this.tabItem.length - 1;\r\n        mjcard.setInsterEndPos(new Vec3(this.tabItemPos[index].x, this.tabItemPos[index].y, 0));\r\n        mjcard.setCanClick(false);\r\n        let t1 = tween(node).to(0.2, { position: new Vec3(this.tabItemPos[index].x, this.tabItemPos[index].y, 0) })\r\n        let t2 = tween(node).call(() => {\r\n            callback()\r\n        });\r\n        node.setSiblingIndex(1000);\r\n        tween(node).sequence(t1, t2).start()\r\n    }\r\n\r\n    //消除物品栏动画\r\n    deleteTabAnima(index, callback) {\r\n        let node2 = this.tabItem[index[2]];\r\n        let node1 = this.tabItem[index[1]];\r\n        let node0 = this.tabItem[index[0]];\r\n        tween(node2)\r\n            .delay(0.1)\r\n            .show()\r\n            .delay(0.1)\r\n            .hide()\r\n            .union()\r\n            .repeat(2)\r\n            .removeSelf()\r\n            .start();\r\n        tween(node1)\r\n            .delay(0.1)\r\n            .show()\r\n            .delay(0.1)\r\n            .hide()\r\n            .union()\r\n            .repeat(2)\r\n            .removeSelf()\r\n            .start();\r\n        tween(node0)\r\n            .delay(0.1)\r\n            .show()\r\n            .delay(0.1)\r\n            .hide()\r\n            .union()\r\n            .repeat(2)\r\n            .removeSelf()\r\n            .call(callback())\r\n            .start();\r\n    }\r\n\r\n    //整理物品栏\r\n    restTopAnima() {\r\n        let self = this;\r\n        if (this.tabItem.length == 0) {\r\n            self.isCanClick = true;\r\n        }\r\n        for (let i = 0; i < this.tabItem.length; i++) {\r\n            if (i == this.tabItem.length - 1) {\r\n                tween(this.tabItem[i])\r\n                    .delay(0.3)\r\n                    .show()\r\n                    .to(0.3, { position: new Vec3(this.tabItemPos[i].x, this.tabItemPos[i].y, 0) })\r\n                    .call(() => {\r\n                        self.isCanClick = true;\r\n                    })\r\n                    .start();\r\n\r\n            }\r\n            else {\r\n                tween(this.tabItem[i])\r\n                    .delay(0.3)\r\n                    .show()\r\n                    .to(0.3, { position: new Vec3(this.tabItemPos[i].x, this.tabItemPos[i].y, 0) })\r\n                    .start();\r\n            }\r\n        }\r\n        //成功过关\r\n        if (this.desktopItems.length == 0) {\r\n            this.gameShowTips(GAMETIPS.game_success);\r\n        }\r\n    }\r\n\r\n    //继续游戏\r\n    contiuneGame() {\r\n        tools.playSound(SOUND.click_sound);\r\n        this.gameTipsNode.active = false;\r\n        this.schedule(this.countdown, 1);\r\n        this.isCanClick = true;\r\n    }\r\n\r\n    //显示:过关成功，失败，提示 \r\n    gameShowTips(typeId) {\r\n\r\n        this.unschedule(this.countdown);\r\n        let spos = new Vec3(-700, 30, 0);\r\n        let epos = new Vec3(0, 30, 0);\r\n\r\n        if (typeId == GAMETIPS.game_hide) //隐藏面板\r\n        {\r\n            this.gameTipsNode.active = false;\r\n        }\r\n        else if (typeId == GAMETIPS.game_contiune)  //继续面板\r\n        {\r\n            this.isCanClick = false;\r\n            this.gameState = GAMESTATE.game_inGame;\r\n            this.gameTipsNode.active = true;\r\n            this.tips_title_label.string = '游戏暂停中';\r\n            this.gameContinueBtn.active = true;\r\n            this.gameRestBtn.active = false;\r\n            this.gameNextBtn.active = false;\r\n            this.updataBtn();\r\n            this.tips_xipai_label.string = '洗 牌: X ' + tools.xiPai;\r\n            this.tips_chehui_label.string = '撤 回: X ' + tools.cheHui;\r\n            this.tips_addtime_label.string = '加 时: ' + tools.addTime + 's';\r\n            this.tips_toushi_label.string = '透 视: X ' + tools.touShi;\r\n            spos = new Vec3(-700, 30, 0);\r\n            epos = new Vec3(0, 30, 0);\r\n            this.gameTipsNode.setPosition(spos);\r\n            tween(this.gameTipsNode)\r\n                .to(0.5, { position: epos }, {  // 这里以node的位置信息坐标缓动的目标 \r\n                    easing: \"quartIn\",          // 缓动函数，可以使用已有的，也可以传入自定义的函数。      \r\n                })\r\n                .start();\r\n        }\r\n        else if (typeId == GAMETIPS.gmae_fail) //失败面板\r\n        {\r\n            tools.playSound(SOUND.gameLost_sound);\r\n            this.isCanClick = false;\r\n            this.gameState = GAMESTATE.game_end;\r\n            this.gameTipsNode.active = true;\r\n            this.tips_title_label.string = '闯关失败，再接再厉!'\r\n            this.gameContinueBtn.active = false;\r\n            this.gameRestBtn.active = true;\r\n            this.gameNextBtn.active = false;\r\n            tools.saveLevel();\r\n            tools.savaData();\r\n            this.updataBtn();\r\n            this.tips_xipai_label.string = '洗 牌: X ' + tools.xiPai;\r\n            this.tips_chehui_label.string = '撤 回: X ' + tools.cheHui;\r\n            this.tips_addtime_label.string = '加 时: ' + tools.addTime + 's';\r\n            this.tips_toushi_label.string = '透 视: X ' + tools.touShi;\r\n            spos = new Vec3(-700, 30, 0);\r\n            epos = new Vec3(0, 30, 0);\r\n            this.gameTipsNode.setPosition(spos);\r\n            tween(this.gameTipsNode)\r\n                .to(0.5, { position: epos }, {  // 这里以node的位置信息坐标缓动的目标 \r\n                    easing: \"quartIn\",          // 缓动函数，可以使用已有的，也可以传入自定义的函数。      \r\n                })\r\n                .start();\r\n        }\r\n        else if (typeId == GAMETIPS.game_success) //成功面板\r\n        {\r\n            tools.playSound(SOUND.gameWin_sound);\r\n            this.isCanClick = false;\r\n            this.gameState = GAMESTATE.game_end;\r\n            this.gameTipsNode.active = true;\r\n            this.tips_title_label.string = '恭喜，闯关成功!'\r\n            this.gameContinueBtn.active = false;\r\n            this.gameRestBtn.active = false;\r\n            this.gameNextBtn.active = true;\r\n            tools.level += 1;       //当前游戏关卡等级\r\n            tools.addTime += 10;\r\n            tools.saveLevel();\r\n            this.setBtnState('gameAddTimeBtn', true, '加时' + tools.addTime + 's');\r\n            tools.savaData();\r\n            this.updataBtn();\r\n            tools.xiPai++;\r\n            tools.cheHui++;\r\n            tools.touShi++;\r\n            this.tips_xipai_label.string = '洗 牌: X ' + tools.xiPai;\r\n            this.tips_chehui_label.string = '撤 回: X ' + tools.cheHui;\r\n            this.tips_addtime_label.string = '加 时: ' + tools.addTime + 's';\r\n            this.tips_toushi_label.string = '透 视: X ' + tools.touShi;\r\n            spos = new Vec3(-700, 30, 0);\r\n            epos = new Vec3(0, 30, 0);\r\n            this.gameTipsNode.setPosition(spos);\r\n            tween(this.gameTipsNode)\r\n                .to(0.5, { position: epos }, {  // 这里以node的位置信息坐标缓动的目标 \r\n                    easing: \"quartIn\",          // 缓动函数，可以使用已有的，也可以传入自定义的函数。      \r\n                })\r\n                .start();\r\n        }\r\n    }\r\n\r\n    //更新道具按钮\r\n    updataBtn() {\r\n        if (this.gameState == GAMESTATE.game_end) {\r\n            this.setBtnState('gameXiPaiBtn', false);\r\n            this.setBtnState('gameCheHuiBtn', false);\r\n            this.setBtnState('gameAddTimeBtn', false);\r\n            this.setBtnState('gameToushiBtn', false);\r\n            this.setBtnState('gameCheHuiBtn', false);\r\n        }\r\n        else {\r\n            //洗牌按钮\r\n            if (tools.xiPai <= 0) {\r\n                this.setBtnState('gameXiPaiBtn', false, '洗牌X0');\r\n            }\r\n            else {\r\n                this.setBtnState('gameXiPaiBtn', true, '洗牌X' + tools.xiPai);\r\n            }\r\n            //撤回按钮\r\n            if (tools.cheHui <= 0 || this.tabItem.length <= 0) {\r\n                this.setBtnState('gameCheHuiBtn', false, '撤回X' + tools.cheHui);\r\n            }\r\n            else {\r\n                this.setBtnState('gameCheHuiBtn', true, '撤回X' + tools.cheHui);\r\n            }\r\n            //加时按钮\r\n            if (tools.addTime <= 0) {\r\n                this.setBtnState('gameAddTimeBtn', false, '加时0s');\r\n            }\r\n            else {\r\n                this.setBtnState('gameAddTimeBtn', true, '加时' + tools.addTime + 's');\r\n            }\r\n            //透视按钮\r\n            if (tools.touShi <= 0) {\r\n                this.setBtnState('gameToushiBtn', false, '透视X0');\r\n            }\r\n            else {\r\n                this.setBtnState('gameToushiBtn', true, '透视X' + tools.touShi);\r\n            }\r\n\r\n        }\r\n        tools.savaData();\r\n    }\r\n\r\n    setBtnState(bttName: string, enable: boolean, btnText: string | null = null) {\r\n        let node = this.node.parent.getChildByName(bttName);\r\n        let label = node.getChildByName('Label').getComponent(Label);\r\n        if (btnText != null) label.string = btnText;\r\n        if (enable) {\r\n            node.getComponent(Sprite).color = color(255, 255, 255, 255);\r\n            node.getComponent(Button).enabled = true;\r\n        }\r\n        else {\r\n            node.getComponent(Sprite).color = color(255, 255, 255, 128);\r\n            node.getComponent(Button).enabled = false;\r\n        }\r\n    }\r\n}\r\n\r\n"]}