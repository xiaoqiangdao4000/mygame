{"version":3,"sources":["file:///Users/zzx/Desktop/mygame/assets/scripts/gameLoadingNode.ts"],"names":["_decorator","Component","instantiate","Label","Sprite","tween","tools","resMgr","ccclass","property","gameLoadingNode","loadingSprite","loadingLabel","onLoad","Instance","console","log","destroy","start","startLoad","node","getChildByName","getComponent","fillRange","string","preLoadResPkg","resPkg","loadingResCallBack","delay","call","enterStartScene","now","total","hideLoadingNode","prefab","getAsset","parent","active"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAeC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AAC7DC,MAAAA,K;;AACAC,MAAAA,M;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;iCAGjBU,e,WADZF,OAAO,CAAC,iBAAD,C,2BAAR,MACaE,eADb,SACqCT,SADrC,CAC+C;AAAA;AAAA;AAAA,eAG3CU,aAH2C,GAGnB,IAHmB;AAGZ;AAHY,eAI3CC,YAJ2C,GAIrB,IAJqB;AAAA;;AAIZ;AAE/BC,QAAAA,MAAM,GAAG;AACL,cAAIH,eAAe,CAACI,QAAhB,KAA6B,IAAjC,EAAuC;AACnCJ,YAAAA,eAAe,CAACI,QAAhB,GAA2B,IAA3B;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACH,WAHD,MAIK;AACD,iBAAKC,OAAL;AACA;AACH;AACJ;;AAEDC,QAAAA,KAAK,GAAG,CACP,CAlB0C,CAoB3C;;;AACAC,QAAAA,SAAS,GAAG;AACR,eAAKR,aAAL,GAAqB,KAAKS,IAAL,CAAUC,cAAV,CAAyB,UAAzB,EAAqCC,YAArC,CAAkDlB,MAAlD,CAArB;AACA,eAAKQ,YAAL,GAAoB,KAAKQ,IAAL,CAAUC,cAAV,CAAyB,YAAzB,EAAuCC,YAAvC,CAAoDnB,KAApD,CAApB;AACA,eAAKQ,aAAL,CAAmBY,SAAnB,GAA+B,CAA/B;AACA,eAAKX,YAAL,CAAkBY,MAAlB,GAA2B,WAA3B,CAJQ,CAMR;;AACA;AAAA;AAAA,gCAAOV,QAAP,CAAgBW,aAAhB,CAA8B;AAAA;AAAA,8BAAMC,MAApC,EAA4C,KAAKC,kBAAjD,EAAqE,MAAM;AACvE;AACAtB,YAAAA,KAAK,CAAC,KAAKe,IAAN,CAAL,CACKQ,KADL,CACW,GADX,EAEKC,IAFL,CAEU,MAAM;AACRnB,cAAAA,eAAe,CAACI,QAAhB,CAAyBgB,eAAzB;AACH,aAJL,EAIOZ,KAJP;AAMH,WARD;AASH,SArC0C,CAuC3C;;;AACAS,QAAAA,kBAAkB,CAACI,GAAD,EAAMC,KAAN,EAAa;AAC3BtB,UAAAA,eAAe,CAACI,QAAhB,CAAyBF,YAAzB,CAAsCY,MAAtC,GAA+C,UAAUO,GAAV,GAAgB,GAAhB,GAAsBC,KAArE;AACAtB,UAAAA,eAAe,CAACI,QAAhB,CAAyBH,aAAzB,CAAuCY,SAAvC,GAAmDQ,GAAG,GAAGC,KAAzD;AACH,SA3C0C,CA6C3C;;;AACAF,QAAAA,eAAe,GAAG;AAEd;AACA,eAAKG,eAAL,GAHc,CAKd;;AACA,cAAIC,MAAM,GAAG;AAAA;AAAA,gCAAOpB,QAAP,CAAgBqB,QAAhB,CAAyB,SAAzB,EAAoC,WAApC,CAAb;AACA,cAAIf,IAAI,GAAGlB,WAAW,CAACgC,MAAD,CAAtB;AACAd,UAAAA,IAAI,CAACgB,MAAL,GAAc,KAAKhB,IAAL,CAAUgB,MAAxB;AAEH,SAxD0C,CA0D3C;;;AACAH,QAAAA,eAAe,GAAG;AACd,eAAKb,IAAL,CAAUiB,MAAV,GAAmB,KAAnB;AACH;;AA7D0C,O,UACpCvB,Q,GAA4B,I","sourcesContent":["import { _decorator, Component, instantiate, Label, Prefab, Sprite, tween } from 'cc';\nimport tools from './tools';\nimport resMgr from './resMgr';\nconst { ccclass, property } = _decorator;\n\n@ccclass('gameLoadingNode')\nexport class gameLoadingNode extends Component {\n    static Instance: gameLoadingNode = null;\n\n    loadingSprite: Sprite = null;  //进度条\n    loadingLabel: Label = null;    //进度条文字\n\n    onLoad() {\n        if (gameLoadingNode.Instance === null) {\n            gameLoadingNode.Instance = this;\n            console.log('初始化 gameLoadingNode 单列!');\n        }\n        else {\n            this.destroy();\n            return;\n        }\n    }\n\n    start() {\n    }\n\n    //先加载资源\n    startLoad() {\n        this.loadingSprite = this.node.getChildByName('loading1').getComponent(Sprite);\n        this.loadingLabel = this.node.getChildByName('loadingStr').getComponent(Label);\n        this.loadingSprite.fillRange = 0;\n        this.loadingLabel.string = '资源加载:开始加载';\n\n        //加载资源\n        resMgr.Instance.preLoadResPkg(tools.resPkg, this.loadingResCallBack, () => {\n            //资源加载完成回调\n            tween(this.node)\n                .delay(0.3)\n                .call(() => {\n                    gameLoadingNode.Instance.enterStartScene();\n                }).start();\n\n        });\n    }\n\n    //资源加载进度\n    loadingResCallBack(now, total) {\n        gameLoadingNode.Instance.loadingLabel.string = '资源加载:' + now + '/' + total;\n        gameLoadingNode.Instance.loadingSprite.fillRange = now / total;\n    }\n\n    //进入开始界面\n    enterStartScene() {\n\n        //隐藏资源加载界面\n        this.hideLoadingNode();\n\n        //加载开始界面\n        let prefab = resMgr.Instance.getAsset('prefabs', 'gameStart') as Prefab;\n        let node = instantiate(prefab);\n        node.parent = this.node.parent;\n\n    }\n\n    //隐藏资源加载界面\n    hideLoadingNode() {\n        this.node.active = false;\n    }\n}\n\n"]}